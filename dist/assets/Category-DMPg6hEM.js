import{r as i,b as L,j as s,L as g,C as b,H as P,g as z,p as F,d as C,c as $}from"./index-g-76tbG9.js";const Y=({searchText:d})=>{const[p,v]=i.useState([]),[h,u]=i.useState([]),[E,D]=i.useState(""),[I,q]=i.useState(!1),[k,m]=i.useState(!0),t=window.localStorage.getItem("lang"),[n,y]=i.useState(null),f=L().pathname.split("/")[2],j={border:"4px solid #f3f3f3",borderTop:"4px solid #DCC38B",borderRadius:"50%",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"0 auto"},[c,N]=i.useState(()=>{try{const e=localStorage.getItem("likedProducts");return e&&e!=="undefined"?JSON.parse(e):[]}catch(e){return console.error("Error parsing likedProducts from localStorage:",e),[]}}),w=localStorage.getItem("sl_option_nav")==="Stroy Baza №1"?0:localStorage.getItem("sl_option_nav")==="Giaz Mebel"?1:2;i.useEffect(()=>{(async()=>{try{m(!0);const[l,o]=await Promise.all([z(f),F(w)]);y(l);const r=o.filter(a=>a.category==f);v(r),u(r)}catch(l){console.error("Error fetching data:",l)}finally{m(!1)}})()},[f,w]),i.useEffect(()=>{if(d.trim()==="")u(p);else{const e=p.filter(l=>{var o;return(o=l[`name_${t}`])==null?void 0:o.toLowerCase().includes(d.toLowerCase())});m(!0),setTimeout(()=>{u(e),m(!1)},1e3)}},[d,p,t]);const S=t==="uz"?"so'm":t==="en"?"uzs":t==="ru"?"сум":"so'm",_=async e=>{const l=localStorage.getItem("userId"),o=c.some(a=>a.product===e);let r;if(!l){o?r=c.filter(a=>a.product!==e):r=[...c,{product:e}],localStorage.setItem("likedProducts",JSON.stringify(r)),N(r);return}if(o){r=c.filter(x=>x.product!==e);const a=c.find(x=>x.product===e&&x.user.toString()===l);if(a)try{await C(a.id)}catch(x){console.error("DELETE xatosi:",x)}}else{r=[...c,{user:Number.parseInt(l),product:e}];try{const a=await $(e,Number.parseInt(l))}catch(a){console.error("POST xatosi:",a);return}}localStorage.setItem("likedProducts",JSON.stringify(r)),N(r)};return s.jsx("div",{className:"w-full mb-[0px] sm:mb-[100px] flex flex-col items-center",children:s.jsxs("div",{className:"mt-[0px] sm:mt-[50px] flex flex-col w-full sm:w-[1440px] m-auto h-auto sm:px-[77px] mb-[100px] sm:mb-[0]",children:[s.jsx("div",{className:"hidden sm:block",children:s.jsxs(g,{className:"w-full flex items-center gap-[10px]",to:"/",children:[s.jsx(b,{className:"scale-110"}),s.jsx("h1",{className:"font-inter font-[500] text-[32px] leading-[45px] text-black",children:(n==null?void 0:n[`name_${t}`])||(t=="uz"?"Yuklanmoqda...":t=="en"?"Loading...":t=="ru"?"Загрузка...":"Yuklanmoqda...")})]})}),s.jsx("div",{className:"sticky top-0 z-50 block sm:hidden",children:s.jsx("div",{className:"w-full h-[65px] bg-[#DCC38B]",children:s.jsxs(g,{className:"w-full h-full flex items-center gap-[10px] pl-[13px]",to:"/search",children:[s.jsx(b,{className:"scale-110"}),s.jsx("h1",{className:"font-inter font-[500] text-[15px] leading-[22px] text-black",children:(n==null?void 0:n[`name_${t}`])||(t=="uz"?"Yuklanmoqda...":t=="en"?"Loading...":t=="ru"?"Загрузка...":"Yuklanmoqda...")})]})})}),k?s.jsx("div",{className:"flex justify-center mx-auto items-center scale-[70%] sm:scale-[100%] w-[200%] h-[130px] sm:w-[500%] sm:h-[400px]",children:s.jsx("div",{style:j})}):h.length>0?s.jsx("div",{className:"mt-[20px] px-[15px] grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-x-[10px] sm:gap-x-[20px] gap-y-[15px] sm:gap-y-[30px]",children:h.map((e,l)=>{var o,r;return s.jsx("div",{className:"cursor-pointer",children:s.jsxs(g,{to:`/product/${e.id}`,children:[s.jsx("div",{className:"rounded-[10px] w-[160px] h-[160px] sm:w-[245px] sm:h-[245px] bg-[#F2F2F1] overflow-hidden group",children:s.jsx("img",{src:`https://backkk.stroybazan1.uz/${e.image}`,className:"object-cover w-full h-full transition-transform group-hover:scale-105",alt:e[`name_${t}`]})}),s.jsxs("div",{className:"flex flex-row items-end w-[165px] sm:w-[245px] justify-between mt-1.5 px-3",children:[s.jsxs("div",{className:"flex flex-col sm:gap-1",children:[s.jsx("h1",{className:"text-black max-w-[120px] sm:max-w-[180px] truncate font-semibold text-[14px] sm:text-[16px]",children:e[`name_${t}`]}),s.jsx("p",{className:"text-black text-[12px] sm:text-[14px]",children:(r=(o=e.variants)==null?void 0:o[0])!=null&&r.price?`${t==="uz"?"Narxi":t==="en"?"Price":t==="ru"?"Цена":"Narxi"}: ${Number.parseFloat(e.variants[0].price).toFixed(2)} ${S}`:t==="uz"?"Narxi mavjud emas":t==="en"?"Price not available":t==="ru"?"Цена не доступна":"Narxi mavjud emas"})]}),s.jsx(P,{className:"w-[19px] h-[19px] sm:w-[28px] sm:h-[28px] text-[#FF0000] cursor-pointer mb-0.5",fill:c.some(a=>a.product===e.id)?"#FF0000":"none",onClick:a=>{a.preventDefault(),_(e.id)}})]})]})},l)})}):s.jsx("div",{className:"flex justify-center mx-auto items-center scale-[70%] sm:scale-[100%] w-[200%] h-[130px] sm:w-[500%] sm:h-[400px]",children:s.jsx("div",{style:j})})]})})};export{Y as default};
